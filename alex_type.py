# -*- coding: utf-8 -*-
import customtkinter
import tkinter as tk
import tkinter.font as tkfont
import time, random, math
import json
import os
from tkinter import messagebox

customtkinter.set_appearance_mode("Dark")
customtkinter.set_default_color_theme("dark-blue")

try:
    from ctypes import windll

    windll.shcore.SetProcessDpiAwareness(1)
except:
    pass

# ===================== ТЕМА =====================
THEME = {
    "bg": "#0a0a0a",
    "card_bg": "#141414",
    "surface": "#1a1a1a",
    "text": "#c8c8c8",
    "subtext": "#3d3d3d",
    "correct": "#c9a84c",  # ЗОЛОТОЙ
    "wrong": "#ff2244",  # КРАСНЫЙ
    "waiting": "#404040",  # СЕРЫЙ
    "cursor": "#c9a84c",
    "gold": "#c9a84c",
    "teal": "#4fa89a",
    "danger": "#cf3636",
    "sh_dark": (0x2e, 0x2e, 0x2e),
    "sh_light": (0x62, 0x62, 0x62),
}

# ===================== БАЗА ТЕКСТОВ =====================
TEXT_BUNDLES = {
    "ru": {
        "classics": [
            "Привет мир.", "Добрый день.", "Как дела?", "Скоро лето.", "Зимний вечер.",
            "Чистый код.", "Быстрая печать.", "Умный дом.", "Новая игра.", "Свежий хлеб.",
            "Яркое солнце.", "Тихий лес.", "Громкий звук.", "Синее море.", "Белый снег.",
            "Красный флаг.", "Зеленый лист.", "Желтый свет.", "Черный кот.", "Серый волк.",
            "Жили-были два брата, Чук и Гек.", "Они жили с матерью в Москве в большой квартире.",
            "Отца дома не было, он жил далеко на севере.", "Днем и ночью отец трудился в тайге.",
            "Пришло от отца письмо, в котором он звал их в гости.",
            "Мать очень обрадовалась и стала собираться в дорогу.",
            "Чук и Гек поссорились из-за пустой коробки.", "Они не знали, что в коробке была телеграмма.",
            "Поезд мчался сквозь снега и леса.", "За окном мелькали деревья, укрытые белыми шапками.",
            "На станции их никто не встретил.", "Ямщик согласился довезти их до базы.",
            "Тайга стояла тихая и величественная.", "В избушке было тепло, но пусто.",
            "Сторож сказал, что отец ушел в лес на охоту.", "Чук спрятал свой игрушечный кинжал под подушку.",
            "Гек пел песню про синий край.", "Ночью выли волки, и было страшно.",
            "Утром они пошли за водой к проруби.", "Вода была ледяная и очень вкусная.",
            "Они увидели следы зайца на снегу.", "Мать пекла лепешки в печи.",
            "Пришел отец, большой и сильный, в медвежьей шубе.", "Радости не было конца.",
            "Они наряжали елку самодельными игрушками.", "Свечи горели ярко, освещая счастливые лица.",
            "Тимур был командиром своей команды.", "Женя нашла на чердаке штурвал.",
            "Ольга играла на аккордеоне.", "Квакин и его шайка воровали яблоки.",
            "На воротах рисовали красную звезду.", "Это значило, что из этого дома человек ушел в армию.",
            "Тимур помогал старушке носить воду.", "Ребята складывали дрова в поленницу.",
            "Гараев запретил Жене общаться с Тимуром.", "Мотоцикл мчался по дороге, поднимая пыль.",
            "Они построили телефон из консервных банок.", "Сигнал тревоги прозвучал внезапно.",
            "Вся команда собралась в старом сарае.", "Нужно было спасать козу, которая убежала.",
            "Георгий приехал в отпуск на несколько дней.", "Они сидели у костра и пели песни.",
            "Маруся разбила голубую чашку.", "Папа рассердился, но ничего не сказал.",
            "Светлана и папа ушли из дома куда глаза глядят.", "Поля были широкие, а небо голубое.",
            "Они встретили пионера Саньку с собакой.", "Мельница стояла у реки, старая и заброшенная.",
            "На лугу паслись коровы.", "Солнце пекло, и хотелось пить.",
            "Они нашли родник с холодной водой.", "Военные учения проходили недалеко от деревни.",
            "Гремели выстрелы, но это было не страшно.", "Вечером они вернулись домой уставшие.",
            "Мама ждала их на крыльце и улыбалась.", "Семья снова была вместе.",
            "Барабанщик бил в барабан, созывая отряд.", "Судьба барабанщика была непростой.",
            "Он остался один в пустой квартире.", "Дядя, который приехал, оказался шпионом.",
            "Мальчик не сразу понял, кто перед ним.", "Он хотел быть полезным и смелым.",
            "В старом пистолете не было патронов.", "Погоня началась внезапно.",
            "Разведчики вышли из леса бесшумно.", "Враг был хитер, но наши победили.",
            "Честное слово - это не пустой звук.", "Мальчик стоял на посту и не мог уйти.",
            "Он дал слово, что не покинет пост.", "Прохожий майор помог ему и снял с поста.",
            "Дым костра поднимался высоко в небо.", "Лето кончалось, и наступала осень.",
            "Листья желтели и падали на землю.", "Школа ждала своих учеников.",
            "Р.В.С. - это загадочные буквы на камне.", "Раненый командир лежал в сарае.",
            "Ребята приносили ему еду и воду.", "Нужно было сообщить своим о беде.",
            "Смелость города берет.", "Дружба помогает преодолеть любые трудности.",
            "Камень у горячего ручья был волшебным.", "Если разбить камень, начнешь жизнь сначала.",
            "Старик не хотел начинать жизнь сначала.", "Ивашка тоже отказался разбивать камень.",
            "Жизнь нужно прожить так, чтобы не было стыдно.", "Счастье каждый понимает по-своему.",
            "Но все вместе люди знали, что надо честно жить.", "Много трудиться и крепко любить эту огромную землю.",
            "Эта земля зовется Советской страной.", "Звезды на башнях Кремля горят ярко.",
            "Москва - сердце нашей Родины.", "Далеко-далеко, в горах, стоит пограничная застава.",
            "Пограничники охраняют наш покой.", "Собака по кличке Алый взяла след.",
            "Нарушитель не пройдет незамеченным.", "Мы плыли на лодке по широкой реке.",
            "Рыба плескалась в воде на закате.", "Комар пищал над ухом, мешая спать.",
            "Утро было туманное и прохладное.", "В лесу росли грибы и ягоды.",
            "Мы набрали полную корзину белых грибов.", "Белка прыгала с ветки на ветку.",
            "Дятел стучал по сосне, добывая жуков.", "Муравейник был похож на большую гору.",
            "Медведь спал в берлоге всю зиму.", "Весна пришла, и ручьи зазвенели.",
            "Скворцы прилетели и заняли скворечники.", "Трава зазеленела на полях.",
            "Трактор выехал в поле пахать землю.", "Урожай будет богатым.",
            "Хлеб - всему голова.", "В пекарне пахло свежим хлебом.",
            "Мальчиш-Кибальчиш не боялся буржуинов.", "Он звал ребят на подмогу.",
            "Плишь да гладь, да божья благодать.", "А буржуинские бомбы летели и взрывались.",
            "Но Красная Армия всех сильней.", "Тайна Мальчиша была великой.",
            "Он не выдал Военную Тайну врагам.", "И похоронили его на зеленом бугре.",
            "Плывут пароходы - привет Мальчишу!", "Летят самолеты - привет Мальчишу!",
            "Пробегают паровозы - привет Мальчишу!", "А пройдут пионеры - салют Мальчишу!",
            "Сказка ложь, да в ней намек.", "Каждый должен быть смелым и честным.",
            "В лесу родилась елочка.", "Метель пела песенку.",
            "Снежок укутывал землю белым одеялом.", "Новый год - праздник чудес.",
            "Дед Мороз принес подарки детям.", "Мы катались на санках с горки.",
            "Лыжи скользили по лыжне быстро.", "Коньки резали лед, оставляя следы.",
            "Зимние каникулы - лучшее время.", "Можно играть в снежки весь день.",
            "Снеговик стоял во дворе с морковкой вместо носа.", "Ведро на голове снеговика съехало набок.",
            "Ветер завывал в трубе.", "Дома было тепло и уютно.",
            "Кот свернулся клубком у печки.", "Часы тикали на стене.",
            "Время шло, и дети росли.", "Они становились взрослыми и умными.",
            "Но память о детстве оставалась навсегда.", "Книги учили добру и справедливости.",
            "Герои книг были примером для подражания.", "Аркадий Гайдар писал для детей.",
            "Его книги читали миллионы ребят.", "Тимуровское движение охватило всю страну.",
            "Помогать старшим - долг каждого пионера.", "Быть верным товарищем - закон.",
            "Никогда не бросать друга в беде.", "Всегда говорить правду, какой бы горькой она ни была.",
            "Смелость - это победа над страхом.", "Трусость - это позор.",
            "Родина начинается с картинки в букваре.", "С хороших и верных товарищей.",
            "Будущее зависит от нас самих.", "Мы строим новый мир.",
            "Пусть всегда будет солнце.", "Пусть всегда будет небо.",
            "Пусть всегда будет мама.", "Пусть всегда буду я.",
            "Лагерь был разбит на берегу реки.", "Вечером жгли костер и пекли картошку.",
            "Звезды отражались в темной воде.", "Соловей пел в кустах черемухи.",
            "Утро начиналось с зарядки.", "Роса блестела на траве как алмазы.",
            "Мы ходили в поход на дальнюю гору.", "С вершины открывался вид на всю долину.",
            "Ветер дул в лицо, свежий и прохладный.", "Облака плыли по небу, как белые корабли.",
            "Мы нашли старую землянку в лесу.", "Там когда-то жили партизаны.",
            "Память о героях жива в наших сердцах.", "Никто не забыт, ничто не забыто.",
            "Победа ковалась в тылу и на фронте.", "Дети помогали взрослым чем могли.",
            "Собирали металлолом и макулатуру.", "Писали письма бойцам на фронт.",
            "Каждое доброе дело приближало победу.", "Дружба проверяется в трудную минуту.",
            "Костер догорал, угли мерцали в темноте.", "Тишина опустилась на лес.",
            "Лишь сверчки стрекотали в траве.", "Завтра будет новый день и новые дела.",
            "Надо выспаться, чтобы набраться сил.", "Сон смыкает глаза, усталость берет свое.",
            "Спокойной ночи, товарищи!", "Мир вашему дому.",
            "Бэк не читал газет, и он не знал, что надвигается беда.",
            "В Санта-Клара-Вэлли стоял большой дом, называвшийся усадьбой судьи Миллера.",
            "Собаки были нужны людям на Севере, большие собаки с густой шерстью.",
            "Люди искали желтый металл во тьме Арктики, и им нужны были помощники.",
            "Бэк жил в большом доме с широкой верандой, увитой розами.",
            "Он был королем над всеми ползающими и летающими тварями в этом поместье.",
            "Отец его был огромный сенбернар, а мать шотландская овчарка.",
            "Шпиц был коварным и опасным врагом, который никогда не упускал шанса.",
            "Они бежали по льду замерзшей реки, лапы стучали в едином ритме.",
            "Холод пронизывал до костей, но густая шерсть и движение грели их.",
            "Закон клыка и дубины правил этим суровым миром.",
            "Голод делал их быстрыми и жестокими, превращая в идеальные машины.",
            "Перро и Франсуа гордились своими собаками, лучшей упряжкой на Аляске.",
            "Белое Безмолвие давило на них своей ледяной тяжестью.",
            "Снег скрипел под нартами, и этот звук был единственным в тишине.",
            "Волки преследовали их по пятам, ожидая момента слабости.",
            "Костер был единственным спасением от смертельного холода.",
            "Человек должен быть сильнее природы, чтобы выжить здесь.",
            "Золото манило людей, лишая их разума и осторожности.",
            "Север не прощает ошибок, он жесток и справедлив.",
            "Собаки выли на луну, предчувствуя долгую полярную ночь.",
            "Лед трещал на реке, грозя поглотить смельчаков.",
            "В глазах волка светился древний голод.",
            "Смок Беллью шел вперед, несмотря на усталость и боль.",
            "Он знал, что остановка означает смерть.",
            "Дружба проверяется в беде, особенно на краю света.",
            "Мартин Иден мечтал о великом будущем и любви.",
            "Море было его стихией, его домом и его судьбой.",
            "Волны разбивались о скалы с грохотом пушечных выстрелов.",
            "Корабль-призрак скользил в тумане, пугая моряков.",
            "Любовь к жизни - самый сильный инстинкт всего живого.",
            "Он полз по снегу, оставляя за собой кровавый след.",
            "Волк и человек смотрели друг другу в глаза.",
            "Побеждает тот, кто не сдается до последнего вздоха.",
            "Природа безразлична к страданиям человека.",
            "Звезды на севере ярче и холоднее, чем где-либо.",
            "Упряжка собак - это единый организм, работающий слаженно.",
            "Кнут погонщика щелкал в морозном воздухе.",
            "Они мечтали о тепле, о еде и о мягкой постели.",
            "Но впереди были только снег, лед и бесконечный путь.",
            "Год 1866 ознаменовался странным происшествием, загадочным феноменом.",
            "Море было спокойно, дул легкий ветер, и Наутилус всплыл на поверхность.",
            "Наутилус плыл под водой с невероятной скоростью, рассекая глубины.",
            "Капитан Немо стоял на мостике, глядя в бездну, полную тайн.",
            "Мы увидели гигантского кальмара, напавшего на судно, его щупальца были ужасны.",
            "Глубины океана скрывают множество тайн, недоступных человеческому глазу.",
            "Профессор Аронакс был поражен увиденным, записывая каждое наблюдение.",
            "Электричество давало свет и тепло на этой лодке, заменяя солнце.",
            "Дети капитана Гранта отправились в опасное путешествие вдоль 37-й параллели.",
            "Патагония встретила их ветрами и бескрайними просторами.",
            "Корабль Дункан шел на всех парах, спасая потерпевших крушение.",
            "Таинственный остров стал их домом, полным загадок и открытий.",
            "Инженер Сайрус Смит мог создать все из ничего, используя лишь свои знания.",
            "Путешествие к центру Земли началось с кратера потухшего вулкана.",
            "Они спускались все глубже, встречая доисторических чудовищ.",
            "Подземное море освещалось электрическим светом неизвестной природы.",
            "Плот из окаменелого дерева плыл по бурным волнам.",
            "Вокруг Земли за 80 дней - пари, которое казалось невозможным.",
            "Филеас Фогг был спокоен и невозмутим в любой ситуации.",
            "Паспарту верой и правдой служил своему господину.",
            "Индия, Япония, Америка проносились за окнами поездов и иллюминаторами кораблей.",
            "Воздушный шар уносил героев на таинственный остров.",
            "Капитан Гаттерас стремился к Северному полюсу, одержимый своей мечтой.",
            "Ледяная пустыня не прощала ошибок, но манила своей чистотой.",
            "Пятнадцатилетний капитан взял командование на себя.",
            "Дик Сэнд был смелым и решительным юношей.",
            "Негоро, коварный кок, строил козни экипажу.",
            "Африка встретила их опасностями и приключениями.",
            "Слоны, львы и работорговцы были на каждом шагу.",
            "Роберт Грант искал своего отца по всему свету.",
            "Жак Паганель, рассеянный географ, путал карты и страны.",
            "Наука - это ключ к пониманию мира.",
            "Человеческий гений способен покорить стихии.",
            "Море - это вечное движение и любовь.",
            "Свобода - это вольный ветер и открытый горизонт.",
            "Кто ищет, тот всегда найдет.",
            "Дружба крепче стали и дороже золота.",
            "Приключения ждут тех, кто готов рискнуть.",
            "Неведомые земли манят путешественников.",
            "Тайна двух океанов была раскрыта.",
            "Плавучий остров путешествовал по морям.",
            "Властелин мира стремился к господству, но проиграл.",
            "Человек должен оставаться человеком в любых обстоятельствах.",
            "Сильный ветер надувал паруса бригантины.",
            "Пираты скрывались в бухте погибших кораблей.",
            "Карта сокровищ была старой и потертой.",
            "Компас указывал строго на север.",
            "Капитан смотрел в подзорную трубу.",
            "На горизонте показалась земля.",
            "Крики чаек возвещали о близости берега.",
            "Прибой шумел, разбиваясь о рифы.",
            "Матросы драили палубу до блеска.",
            "Боцман свистел в свой свисток.",
            "Быть или не быть, вот в чем вопрос. Достойно ль смиряться под ударами судьбы?",
            "Весь мир - театр. В нём женщины, мужчины - все актеры.",
            "Ромео, Ромео, о зачем же ты Ромео? Отрекись от отца и имя измени.",
            "Теперь зима тревоги нашей позади, и тучи в океане погребены.",
            "Любовь бежит от тех, кто гонится за нею, а тем, кто прочь бежит, кидается на шею.",
            "Опасна власть, когда с ней совесть в ссоре.",
            "У бурных чувств неистовый конец, он совпадает с мнимой их победой.",
            "Что значит имя? Роза пахнет розой, хоть розой назови ее, хоть нет.",
            "Трус умирает много раз до смерти, а храбрый умирает только раз.",
            "Краткость - сестра таланта.",
            "Коня! Коня! Полцарства за коня!",
            "Прогнило что-то в Датском королевстве.",
            "Грехи других судить Вы так усердно рветесь, начните со своих и до чужих не доберетесь.",
            "Любовь слепа и нас лишает глаз, не видим мы того, что видно ясно.",
            "Сомненья - предатели: заставляют нас терять то, что мы могли бы выиграть.",
            "Нет ничего ни хорошего, ни плохого; это размышление делает все таковым.",
            "Мы знаем, кто мы есть, но не знаем, кем мы можем быть.",
            "Время идет для разных лиц различно.",
            "Бедный раздавленный червь вправе сжаться.",
            "Влюбиться можно в красоту, но полюбить - лишь только душу.",
            "Где мало слов, там вес они имеют.",
            "Зло, творимое людьми, живет после них.",
            "Как часто нас спасает слепота, где дальновидность только бы сгубила.",
            "Легче получить прощение, чем разрешение.",
            "Любовь всесильна: нет на земле ни горя - выше кары ее, ни счастья - выше наслаждения ею.",
            "Молитва без усердья - слова на ветер.",
            "Музыка - пища любви.",
            "Надежда - посох любви; отправляйся, вооружившись им против внушений отчаяния.",
            "Наши сомнения - это наши предатели.",
            "Не все то золото, что блестит.",
            "О, как несчастен тот, кто не может простить себя.",
            "Ожидание - корень всех сердечных болей.",
            "Под маской счастья скрывается беда.",
            "Природа-мать мудра, да сын безмозглый.",
            "Самое лучшее - прямо и просто сказанное слово.",
            "Слова - это ветер, а бранные слова - сквозняк.",
            "Слушай многих, говори с немногими.",
            "Смелость - начало победы.",
            "Судьба не с теми, кто ее ждет, а с теми, кто ее творит.",
            "Тот, кто любит, не может быть мудрым.",
            "У каждого безумия есть своя логика.",
            "Ход времени не остановить, но его можно наполнить смыслом.",
            "Чем страсть сильнее, тем печальней бывает у нее конец.",
            "Я не обязан вам ничем, кроме любви.",
            "Ярость - плохой советчик.",
            "Ад пуст, все черти здесь.",
            "Безумие сильных мира сего не должно оставаться без присмотра.",
            "Более грешен тот, кто искушает, чем тот, кто грешит.",
            "В одну минуту можно разбить сердце, которое заживало годами.",
            "В этом мире нет ничего вечного, кроме перемен.",
            "Внешность часто обманчива.",
            "Воображение правит миром.",
            "Время лечит раны, но оставляет шрамы.",
            "Все влюбленные клянутся исполнить больше, чем могут.",
            "Где нет любви, там нет и истины.",
            "Глупость и мудрость схватываются так же легко, как и заразные болезни.",
            "Дайте мне маску, и я скажу вам правду.",
            "Друг всем - ничей друг.",
            "Жизнь - это сказка, рассказанная идиотом, полная шума и ярости.",
            "Зависть - это яд для души.",
            "Здоровье - дороже золота.",
            "Истина всегда проста.",
            "Истинная любовь не знает преград.",
            "Каждый человек - кузнец своего счастья.",
            "Когда говорит оружие, законы молчат.",
            "Корона не лечит от головной боли.",
            "Красота спасает мир, но кто спасет красоту?",
            "Кто рано встает, тому Бог подает.",
            "Лесть - это пища глупцов.",
            "Лицо - зеркало души.",
            "Лучше быть королем в шалаше, чем рабом во дворце.",
            "Любовь - это безумие, но какое прекрасное.",
            "Мир тесен, а слой тонок.",
            "Молчание - знак согласия.",
            "Мы все - должники смерти.",
            "Не верь ушам, верь глазам.",
            "Не суди, да не судим будешь.",
            "Ничего не бойся, кроме страха.",
            "Одиночество - удел сильных.",
            "От любви до ненависти один шаг.",
            "Память - это единственный рай, из которого нас не могут изгнать.",
            "Правда всегда всплывает наружу.",
            "Предательство - самый страшный грех.",
            "Привычка - вторая натура.",
            "Пустые сосуды гремят громче всего.",
            "Разум - лучший лекарь.",
            "Слава - это тень добродетели.",
            "Слезы - это слова, которые сердце не может произнести.",
            "Слова могут ранить больнее меча.",
            "Смех продлевает жизнь.",
            "Совесть - это голос Бога в человеке.",
            "Сон - лучшее лекарство.",
            "Страх делает волков из овец.",
            "Счастье любит тишину.",
            "Тайна, которую знают двое, уже не тайна.",
            "Терпение - это добродетель.",
            "Умный человек учится на чужих ошибках.",
            "Утро вечера мудренее.",
            "Честность - лучшая политика.",
            "Что посеешь, то и пожнешь.",
            "Язык мой - враг мой.",
            "Слуги дьявола - это наши собственные страсти.",
            "Тот, кто шутит над шрамами, не знал ран.",
            "Весь мир - сцена, а люди в нем актеры.",
            "Любовь утешает, как солнце после дождя.",
            "Лучше умный враг, чем глупый друг.",
            "Ничего не выйдет из ничего.",
            "Слабость, имя твое - женщина.",
            "Время - это старый судья.",
            "Золотой век - это когда золото не ценилось.",
            "Пьер был неуклюж. Толстый, выше обыкновенного роста, широкий, с огромными красными руками.",
            "Все мысли, которые имеют огромные последствия, всегда просты.",
            "Наташа в эту зиму в первый раз начала серьезно петь и в особенности оттого, что Денисов восторгался ее пением.",
            "Лови минуты счастия, заставляй себя любить, влюбляйся сам! Только это одно есть настоящее на свете.",
            "Нет величия там, где нет простоты, добра и правды.",
            "Война не любезность, а самое гадкое дело в жизни, и надо понимать это и не играть в войну.",
            "Надо жить, надо любить, надо верить.",
            "Сражение выиграет тот, кто твердо решил его выиграть.",
            "Спокойствие - душевная подлость.",
            "Чтобы жить честно, надо рваться, путаться, биться, ошибаться.",
            "Начинать и бросать, и опять начинать, и опять бросать, и вечно бороться и лишаться.",
            "А спокойствие - душевная подлость.",
            "Каждый человек носит в глубине своего я маленькое кладбище, где погребены те, кого он любил.",
            "Люди живут так, как будто никогда не умрут, а умирают так, как будто никогда не жили.",
            "Сильнее всех воинов - эти два: время и терпение.",
            "Все приходит вовремя к тому, кто умеет ждать.",
            "Власть - это не средство, это цель.",
            "Счастье не в том, чтобы делать всегда, что хочешь, а в том, чтобы всегда хотеть того, что делаешь.",
            "Человек должен быть всегда счастливым, если счастье кончается, смотри, в чем ошибся.",
            "Любовь есть сущность души, она должна укрепиться и очиститься.",
            "Без любви жить легче. Но без нее нет смысла.",
            "Слово - дело великое. Великое потому, что словом можно соединить людей, словом можно и разъединить их.",
            "Словом можно служить любви, словом же можно служить вражде и ненависти.",
            "Берегись такого слова, которое разъединяет людей.",
            "Знание только тогда знание, когда оно приобретено усилиями своей мысли, а не памятью.",
            "Единственный смысл жизни человека - это совершенствование своей бессмертной основы.",
            "Все счастливые семьи похожи друг на друга, каждая несчастливая семья несчастлива по-своему.",
            "Если ты любишь, то любишь всего человека, какой он есть, а не каким я хочу, чтоб он был.",
            "Уважение выдумали для того, чтобы скрывать пустое место, где должна быть любовь.",
            "Мы спим, пока не полюбим.",
            "Люди часто гордятся чистотой своей совести только потому, что у них короткая память.",
            "Все строят планы, и никто не знает, доживет ли он до вечера.",
            "Нет таких условий, к которым не мог бы привыкнуть человек, особенно если он видит, что все окружающие живут так же.",
            "Простота - необходимое условие прекрасного.",
            "Чем виноватее сам перед своей совестью, тем охотнее и невольно ищешь вину других.",
            "Иллюзия того, что счастье в будущем, мешает быть счастливым в настоящем.",
            "Надо верить в возможность счастья, чтобы быть счастливым.",
            "Делай то, что должно, и пусть будет, что будет.",
            "Живи так, как будто ты сейчас должен проститься с жизнью.",
            "Как будто время, которое ты упустил, уже не вернешь.",
            "Зло войны и благо мира до такой степени известны людям, что с тех пор, как мы знаем людей, самым лучшим пожеланием было приветствие: «мир вам».",
            "Истинная сила человека не в порывах, а в нерушимом спокойствии.",
            "Самая трудная, но и самая важная работа - это работа над собой.",
            "Не бойся незнания, бойся ложного знания.",
            "От этого все зло мира.",
            "Для того чтобы воспринимать чужие мысли, надо не иметь своих.",
            "Один из самых обычных и ведущих к самым большим бедствиям соблазнов есть соблазн словами: «Все так делают».",
            "Никогда не беспокой другого тем, что ты можешь сделать сам.",
            "Всякая мысль, выраженная словами, есть сила, действие которой беспредельно.",
            "Любить - значит жить жизнью того, кого любишь.",
            "Самый лучший человек тот, кто живет преимущественно своими мыслями и чужими чувствами.",
            "Самый худший сорт человека - тот, кто живет чужими мыслями и своими чувствами.",
            "Всякий пусть метет перед своей дверью. Если каждый будет делать так, вся улица будет чиста.",
            "Добро есть вечная, высшая цель нашей жизни.",
            "Как ни говори, а родной язык всегда останется родным.",
            "Музыка - это стенография чувств.",
            "Не верь ушам, верь глазам.",
            "Воспитание представляется сложным и трудным делом только до тех пор, пока мы хотим воспитывать своих детей или кого бы то ни было, не воспитывая себя.",
            "Если же поймешь, что воспитывать других мы можем только через себя, то упраздняется вопрос о воспитании и остается один вопрос жизни: как самому жить хорошо.",
            "Я знаю, что ничего не знаю. И это высшая степень человеческой премудрости.",
            "Мир движется вперед благодаря тем, кто страдает.",
            "Каждый хочет изменить человечество, но никто не задумывается о том, как изменить себя.",
            "Вера есть знание смысла человеческой жизни.",
            "Смерть не страшна, страшно то, что мы делаем с жизнью.",
            "Человек подобен дроби: числитель - то, что он есть, а знаменатель - то, что он о себе думает.",
            "Чем больше знаменатель, тем меньше дробь.",
            "Глаза - зеркало души.",
            "У меня нет всего, что я люблю. Но я люблю все, что у меня есть.",
            "Счастье не в том, чтобы делать, что хочешь, а в том, чтобы хотеть то, что делаешь.",
            "Мы не любим людей не потому, что они злы, а мы считаем их злыми, потому что не любим их.",
            "Человек не может владеть ничем, пока он боится смерти.",
            "А кто не боится ее, тому принадлежит все.",
            "Бог есть любовь.",
            "Жизнь есть увеличение души.",
            "Мудрость - это знать, в чем дело жизни, и как исполнять его.",
            "Никто не может быть свободным, если он не господин самому себе.",
            "Самое короткое выражение смысла жизни такое: мир движется и совершенствуется.",
            "Главная задача человека - это участвовать в этом движении, подчиняясь ему и содействуя ему.",
            "Спасение не в обрядах, таинствах, не в исповедании той или иной веры, а в ясном понимании смысла своей жизни.",
            "Правда не в силе, а сила в правде.",
            "Чем больше мы даем, тем больше мы получаем.",
            "Любовь уничтожает смерть и превращает ее в пустой призрак.",
            "Жизнь, превращенная в служение другим, становится бессмертной.",
            "Только то знание, которое делает нас лучше, есть полезное знание.",
            "Все остальное - лишь забава ума.",
            "Совесть - это наш внутренний судья, который никогда не ошибается.",
            "Она говорит нам, что хорошо, а что дурно.",
            "Слушай свою совесть, и ты никогда не собьешься с пути.",
            "Человек счастлив, когда он живет в гармонии с собой и миром.",
            "Природа - это храм, в который человек входит с благоговением.",
            "Мы - часть природы, и мы должны беречь ее.",
            "Уничтожая природу, мы уничтожаем самих себя.",
            "Будущее принадлежит тем, кто верит в красоту своей мечты.",
            "Мечтайте, творите, любите!",
            "Все великое начинается с малого.",
            "Каждая секунда жизни - это бесценный дар.",
            "Улыбка может растопить лед в сердце.",
            "Доброе слово лечит душу.",
            "Не суди книгу по обложке.",
            "Жизнь - это путешествие, а не пункт назначения.",
            "Ошибки - это уроки, которые делают нас мудрее.",
            "Никогда не сдавайся, даже если кажется, что выхода нет.",
            "Свет всегда побеждает тьму.",
            "Мёд никогда не портится, его находили в гробницах фараонов.", "У осьминога три сердца и голубая кровь.",
            "Бананы это ягоды, а клубника это орех.",
            "Венера вращается по часовой стрелке, в отличие от других планет.",
            "У жирафа черный язык, длина которого может достигать полуметра.", "Вода покрывает 70% поверхности Земли.",
            "Улитка может спать три года подряд не просыпаясь.",
            "Колибри единственная птица, которая умеет летать задом наперед.",
            "Белые медведи на самом деле не белые, их кожа черная.", "Крокодилы глотают камни, чтобы нырять глубже.",
            "Слоны единственные животные с ногами, которые не умеют прыгать.",
            "Муравьи никогда не спят и не имеют легких.",
            "Дельфины спят с одним открытым глазом.", "Кошки не чувствуют сладкий вкус из-за мутации генов.",
            "Самая сильная мышца в теле человека относительно размера - язык.", "Нельзя чихнуть с открытыми глазами.",
            "В космосе абсолютная тишина, так как там нет воздуха.",
            "Человеческий мозг генерирует электричество, достаточное для лампочки.",
            "Алмазы самый твердый природный материал на Земле.",
            "Горячая вода замерзает быстрее, чем холодная, это эффект Мпембы.",
            "Выдры держатся за руки во сне, чтобы их не унесло течением.",
            "У коров есть лучшие друзья, и они грустят в разлуке.",
            "Пингвины делают предложение, вручая избраннице идеальный камушек.",
            "Морские коньки - единственные животные, у которых рожает самец.",
            "Бессмертная медуза Turritopsis dohrnii может жить вечно.",
            "Сердце синего кита размером с легковой автомобиль.",
            "У акул нет костей, их скелет состоит из хрящей.", "Бабочки чувствуют вкус ногами.",
            "Глаз страуса больше, чем его мозг.", "Свиньи не могут смотреть в небо физически.",
            "Крысы смеются, если их пощекотать.", "Кенгуру не умеют ходить задом наперед.",
            "Зубы бобра никогда не прекращают расти.", "Ленивцы переваривают пищу две недели.",
            "У тигров полосатая не только шерсть, но и кожа.", "Фламинго розовые из-за креветок, которых они едят.",
            "Хамелеоны меняют цвет не для маскировки, а от настроения.", "Коалы спят по 22 часа в сутки.",
            "У золотых рыбок память не 3 секунды, а несколько месяцев.", "Вороны запоминают лица людей и могут мстить.",
            "Пчелы могут распознавать человеческие лица.", "У пауков прозрачная кровь, которая синеет на воздухе.",
            "Змеи чуют запахи языком.", "Летучие мыши - единственные млекопитающие, способные летать.",
            "У коз прямоугольные зрачки, дающие обзор 340 градусов.", "Зебры белые в черную полоску, а не наоборот.",
            "Крот может прорыть туннель длиной 70 метров за одну ночь.",
            "У дятла язык оборачивается вокруг черепа, защищая мозг.",
            "Скорпионы светятся в ультрафиолете.", "Гепарды не умеют рычать, они мяукают как кошки.",
            "Снежный барс не умеет рычать.", "Лошади спят стоя.",
            "У собак уникальный отпечаток носа, как пальцы у людей.",
            "Кошки спят 70% своей жизни.", "Утки крякают без эха.", "Лягушки пьют воду через кожу.",
            "Стрекозы живут на Земле уже 300 миллионов лет.", "Тараканы могут жить без головы несколько недель.",
            "Мухи жужжат в тональности Фа мажор.", "Комаров привлекает запах бананов.",
            "Самое высокое дерево в мире - Гиперион, его высота 115 метров.", "Бамбук растет до 90 см в сутки.",
            "В Антарктиде есть кровавый водопад.", "Сахара - не самая большая пустыня, самая большая - Антарктическая.",
            "Эверест растет на 4 мм каждый год.", "В Тихом океане есть мусорное пятно размером с Францию.",
            "Молния ударяет в Землю 100 раз в секунду.", "Ветер на Нептуне дует со скоростью 2000 км/ч.",
            "На Юпитере и Сатурне идут дожди из алмазов.", "Один день на Венере длится дольше, чем год на Венере.",
            "Солнце составляет 99.8% массы всей Солнечной системы.", "Луна удаляется от Земли на 3.8 см в год.",
            "Нейтронная звезда весит как миллиард тонн в чайной ложке.",
            "Свет от Солнца идет до Земли 8 минут 20 секунд.",
            "Млечный Путь пахнет ромом и малиной из-за химических соединений.",
            "В космосе есть облако спирта диаметром 463 млрд км.",
            "Самая холодная температура во Вселенной - минус 273 градуса.", "Черные дыры могут испаряться.",
            "ДНК человека и банана совпадают на 50%.", "Атомы на 99.9% состоят из пустоты.",
            "Стекло - это жидкость, которая течет очень медленно.", "Огонь не имеет тени.",
            "Вода - единственное вещество, которое бывает в трех состояниях.",
            "Кислород имеет цвет - он бледно-голубой в жидком виде.",
            "Самый редкий элемент на Земле - астат.", "Золото съедобно.",
            "Железо в нашей крови пришло из взорвавшихся звезд.",
            "Динамит делают из арахиса.", "Первый компьютерный баг был настоящим жуком.",
            "Интернету весит примерно как клубника (в электронах).", "Первая веб-камера следила за кофейником.",
            "Символ @ называли собачкой только в России.", "В Норвегии пингвина посвятили в рыцари.",
            "В Японии есть остров, населенный только кроликами.", "В Австралии больше кенгуру, чем людей.",
            "В Исландии нет комаров.", "Канада имеет больше озер, чем остальной мир вместе взятый.",
            "Россия больше Плутона по площади.", "В Китае запрещены путешествия во времени в фильмах.",
            "Эйфелева башня летом вырастает на 15 см из-за тепла.", "Пирамиды строили не рабы, а наемные рабочие.",
            "Клеопатра жила ближе к изобретению айфона, чем к пирамидам.",
            "Оксфордский университет старше Ацтекской империи.",
            "Наполеон не был коротышкой, это ошибка перевода мер.", "Викинги не носили рогатые шлемы.",
            "Шекспир придумал имя Джессика.", "Кетчуп раньше продавали как лекарство.",
            "Чайные пакетики появились случайно.", "Микроволновку изобрели случайно, растопив шоколадку.",
            "Кока-Кола изначально была зеленой.", "В мире больше телефонов, чем зубных щеток.",
            "Тетрис - самая продаваемая игра в истории.", "Марио зовут Марио Марио.",
            "Самая короткая война в истории длилась 38 минут.", "У медуз нет мозга, сердца и костей.",
            "В Шотландии национальное животное - единорог.", "Авокадо - это фрукт, а не овощ.",
            "В казино Лас-Вегаса нет часов и окон.", "Страусы могут бежать быстрее лошадей.",
            "В языке эскимосов сотни слов для обозначения снега.", "Человеческий глаз различает 10 миллионов цветов.",
            "Кости человека прочнее бетона при сжатии.", "В теле человека достаточно железа, чтобы сделать гвоздь.",
            "В Японии выращивают квадратные арбузы для удобства хранения.", "У морских звезд нет крови.",
            "Плутон не успел сделать ни одного оборота вокруг Солнца с момента открытия до лишения статуса планеты.",
            "Флаг Аляски создал 13-летний мальчик.", "В Австралии есть озеро розового цвета Хиллиер.",
            "Первый будильник мог звонить только в 4 утра.",
            "В Мичигане можно получить лицензию на охоту на единорога.",
            "Королева Елизавета II была механиком во время Второй мировой войны.", "На Луне есть мячи для гольфа.",
            "В космосе невозможно плакать, так как слезы не текут вниз.", "У улитки около 14 000 зубов.",
            "Слух - самое быстрое чувство человека.", "Человек моргает около 28 000 раз в день.",
            "Язык хамелеона в два раза длиннее его тела.",
            "Самая длинная пробка в мире была в Китае и длилась 12 дней.",
            "В Финляндии штрафы за превышение скорости зависят от дохода.",
            "В Швейцарии незаконно владеть одной морской свинкой.",
            "Панды едят до 12 часов в день.", "Колибри делают до 80 взмахов крыльями в секунду.",
            "Сердце креветки находится в голове.", "У свиней оргазм длится 30 минут.",
            "В среднем человек проводит 6 месяцев жизни, ожидая зеленого света светофора.",
            "Самое старое дерево в мире старше 4800 лет.",
            "На Сатурне дуют ветра со скоростью 1800 км/ч.", "В космосе металлы могут свариваться сами по себе.",
            "Человеческий нос может запомнить 50 000 различных запахов.",
            "Отпечаток языка у каждого человека уникален.",
            "Самая большая снежинка в мире была 38 см в ширину.", "В 18 веке ананасы были символом богатства.",
            "Первая почтовая марка появилась в 1840 году.", "В мире существует более 7500 сортов яблок.",
            "Чтобы сделать килограмм меда, пчела должна облететь 2 миллиона цветков.", "У кошек 32 мышцы в каждом ухе.",
            "Жирафы спят всего от 10 минут до 2 часов в сутки.", "В Новой Зеландии больше овец, чем людей.",
            "В мире существует бессмертное существо - медуза Turritopsis dohrnii.",
            "Свет от Солнца достигает Земли за 8 минут.",
            "Все лебеди в Англии принадлежат королеве.",
            "В среднем человек проходит за жизнь расстояние, равное трем экваторам.",
            "В Антарктиде есть почтовое отделение.", "Самая глубокая точка океана - Марианская впадина.",
            "Эверест - самая высокая гора в мире.", "Нил - самая длинная река в мире.",
            "Тихий океан - самый большой океан на Земле.", "Амазонские леса производят 20% кислорода Земли.",
            "В мире более 8000 языков.", "Самая маленькая страна в мире - Ватикан.",
            "Россия - самая большая страна в мире.", "Китай - самая населенная страна в мире.",
            "Токио - самый населенный город в мире.", "Самое быстрое животное на суше - гепард.",
            "Самое большое животное в мире - синий кит.", "Самая большая птица в мире - страус.",
            "Самая маленькая птица в мире - колибри.", "Самая ядовитая змея - тайпан.",
            "Самый быстрый водный житель - парусник.", "Самое высокое здание в мире - Бурдж-Халифа.",
            "Первый человек в космосе - Юрий Гагарин.", "Первый человек на Луне - Нил Армстронг.",
            "Интернет появился в 1969 году.", "Первый смартфон появился в 1992 году.",
            "YouTube был создан в 2005 году.", "Google был основан в 1998 году.",
            "Facebook был основан в 2004 году.", "Apple была основана в 1976 году.",
            "Microsoft была основана в 1975 году.", "Amazon был основан в 1994 году.",
            "Биткоин появился в 2009 году.", "Первый автомобиль был создан в 1886 году.",
            "Первый самолет полетел в 1903 году.", "Титаник утонул в 1912 году.",
            "Первая мировая война началась в 1914 году.", "Вторая мировая война началась в 1939 году.",
            "Человек состоит на 60% из воды.", "В теле взрослого человека 206 костей.",
            "Самый большой орган человека - кожа.", "Сердце бьется около 100 000 раз в день.",
            "Легкие - единственный орган, который может плавать в воде.", "Печень может восстанавливаться.",
            "Мозг потребляет 20% энергии тела.", "В глазу человека около 107 миллионов клеток.",
            "Волосы растут со скоростью около 1 см в месяц.", "Ногти на руках растут быстрее, чем на ногах.",
            "У человека 32 зуба.", "Вкус еды зависит от запаха.",
            "Сон необходим для памяти.", "Смех полезен для здоровья.",
            "Музыка влияет на настроение.", "Чтение развивает мозг.",
            "Самый тяжелый орган человека - печень, она весит около 1,5 кг.",
            "Кровь проходит полный круг кровообращения за 20-25 секунд.",
            "Самая маленькая косточка находится в ухе и называется стремечко.",
            "У человека в теле более 600 мышц.",
            "Желудок обновляет свою слизистую оболочку каждые 3-4 дня.",
            "Сердце женщины бьется быстрее, чем сердце мужчины.",
            "Человек растет во сне.",
            "Утром человек выше, чем вечером, из-за сжатия межпозвоночных дисков.",
            "Отпечатки пальцев появляются у плода на 3-м месяце беременности.",
            "У каждого человека уникальный рисунок радужной оболочки глаза.",
        ],
        "wikipedia": []
    },
    "en": {
        "mixed": [
            "Hello world.", "Good morning.", "Happy day.", "Fast car.", "Blue sky.",
            "Green tree.", "Red apple.", "Big house.", "Small cat.", "Funny dog.",
            "Hot coffee.", "Cold water.", "Night light.", "Open door.", "Close call.",
            "Hard work.", "Easy life.", "True love.", "Best friend.", "New year.",
            "Clean room.", "Smart phone.", "Fresh air.", "Bright star.", "Quiet place.",
            "Loud noise.", "Deep sea.", "White snow.", "Black box.", "Grey wolf.",
            "Here is Edward Bear, coming downstairs now, bump, bump, bump, on the back of his head.",
            "Winnie-the-Pooh sat down at the foot of the tree and began to think.",
            "The only reason for making a buzzing-noise that I know of is because you are a bee.",
            "He climbed and he climbed and he climbed, and as he climbed he sang a little song.",
            "It all comes of liking honey so much.",
            "The first person he met was Rabbit.",
            "You can't be in London at five minutes to eleven when you are in the Forest.",
            "Promise you won't forget me, ever, not even when you're a hundred.",
            "People say nothing is impossible, but I do nothing every day.",
            "A little Consideration, a little Thought for Others, makes all the difference.",
            "Where is Papa going with that ax? said Fern to her mother.",
            "Fern pushed a chair out of the way and ran outdoors.",
            "Wilbur was what farmers call a spring pig, which simply means that he was born in springtime.",
            "Salutations! said the voice from the web.",
            "I am a spider, said the voice.",
            "Charlotte is the best friend a pig ever had.",
            "It is not often that someone comes along who is a true friend and a good writer.",
            "Wilbur never forgot Charlotte.",
            "It is a miracle, said the minister, and he truly believed it.",
            "Life is always a rich and steady time when you are waiting for something to happen or to hatch.",
            "Alice was beginning to get very tired of sitting by her sister on the bank.",
            "Suddenly a White Rabbit with pink eyes ran close by her.",
            "The Rabbit actually took a watch out of its waistcoat-pocket and looked at it.",
            "Down, down, down, would the fall never come to an end?",
            "She came upon a low curtain she had not noticed before, and behind it was a little door.",
            "Curiouser and curiouser! cried Alice.",
            "We are all mad here, I am mad, you are mad.",
            "Off with their heads! shouted the Queen.",
            "Wake up, Alice dear! said her sister.",
            "Who in the world am I? Ah, that is the great puzzle.",
            "Once there were four children whose names were Peter, Susan, Edmund and Lucy.",
            "They opened the door and they all found themselves standing in the spare room.",
            "She looked back over her shoulder and there she could still see the open doorway of the wardrobe.",
            "I am in the middle of a wood at night-time in the snow!",
            "It is always winter but never Christmas.",
            "Aslan is a lion, the Lion, the great Lion.",
            "Wrong will be right, when Aslan comes in sight.",
            "She has no right to be Queen.",
            "Once a King or Queen of Narnia, always a King or Queen of Narnia.",
            "He is not a tame lion, you know.",
            "When Mary Lennox was sent to Misselthwaite Manor she was the most disagreeable-looking child ever seen.",
            "She had a little thin face and a little thin body, thin light hair and a sour expression.",
            "Mistress Mary, quite contrary, how does your garden grow?",
            "There was a door in the ivy-covered wall.",
            "It was the sweetest, most mysterious-looking place anyone could imagine.",
            "I am Colin, said the boy in the bed.",
            "The secret garden was not dead, it was only sleeping.",
            "Magic is always pushing and drawing and making things out of nothing.",
            "If you look the right way, you can see that the whole world is a garden.",
            "Where you tend a rose, my lad, a thistle cannot grow.",
            "Matilda was a little late in starting to talk, but she learned quickly.",
            "By the time she was three, Matilda had taught herself to read by studying newspapers.",
            "Mr. Wormwood was a small rat-faced man whose front teeth stuck out underneath a thin ratty moustache.",
            "The books transported her into new worlds and introduced her to amazing people.",
            "Miss Honey was a mild and quiet person who never raised her voice.",
            "The Trunchbull was a gigantic holy terror, a fierce tyrannical monster.",
            "Never do anything by halves if you want to get away with it.",
            "Be outrageous. Go the whole hog.",
            "Matilda said, never do anything by halves if you want to get away with it.",
            "Somewhere inside all of us is the power to change the world.",
            "There were five children in the bucket family, and they were very poor.",
            "In the town itself, actually within sight of the house, there was an enormous chocolate factory.",
            "I, Willy Wonka, have decided to allow five children to visit my factory this year.",
            "The first finder of the Golden Ticket was a boy called Augustus Gloop.",
            "Charlie Bucket found some money in the snow.",
            "Slowly, he peeled back the wrapper of the chocolate bar.",
            "It was a Golden Ticket!",
            "Mr. Willy Wonka was standing all alone just inside the open gates of the factory.",
            "The waterfall is most important! It mixes the chocolate!",
            "Don't forget what happened to the man who suddenly got everything he always wanted.",
            "Dorothy lived in the midst of the great Kansas prairies, with Uncle Henry and Aunt Em.",
            "The house whirled around two or three times and rose slowly through the air.",
            "She was awakened by a shock, so sudden and severe that if she had not been lying on the soft bed she might have been hurt.",
            "I am the Witch of the North.",
            "Follow the yellow brick road.",
            "I am going to the Emerald City to ask the Great Oz to send me back to Kansas.",
            "I want a brain, said the Scarecrow.",
            "I want a heart, said the Tin Woodman.",
            "I want courage, said the Cowardly Lion.",
            "There is no place like home.",
            "Mr. and Mrs. Dursley were proud to say that they were perfectly normal, thank you very much.",
            "Harry had a thin face, knobbly knees, black hair, and bright green eyes.",
            "On his forehead was a thin scar that was shaped like a bolt of lightning.",
            "You're a wizard, Harry.",
            "Harry Potter was a wizard - a wizard fresh from his first year at Hogwarts School of Witchcraft and Wizardry.",
            "The wand chooses the wizard, Mr. Potter.",
            "Keep an eye on the staircases, they like to change.",
            "It does not do to dwell on dreams and forget to live.",
            "It takes a great deal of bravery to stand up to our enemies, but just as much to stand up to our friends.",
            "To the well-organized mind, death is but the next great adventure.",
            "I know I am not an ordinary ten-year-old kid.",
            "My name is August, by the way. I won't describe what I look like.",
            "Whatever you are thinking, it is probably worse.",
            "When given the choice between being right or being kind, choose kind.",
            "Everyone in the world should get a standing ovation at least once in their life because we all overcometh the world.",
            "Courage, kindness, friendship, character, these are the qualities that define us.",
            "It is not enough to be friendly, you have to be a friend.",
            "We carry with us, as human beings, not just the capacity to be kind, but the very choice of kindness.",
            "The things we do outlast our mortality.",
            "You are a wonder, Auggie."
        ]
    }
}


class AlexTypeTrainer:
    def __init__(self, root):
        self.root = root
        self.root.title("AlexType")
        self.root.attributes('-fullscreen', True)
        self.root.bind("<F11>", lambda e: self.root.attributes('-fullscreen', not self.root.attributes('-fullscreen')))

        self.lang = "ru"
        self.xp_level = 10  # 10, 50, 100, 200, 500, 1000
        self.total_xp = self.load_progress()  # ЗАГРУЗКА XP

        self.current_sentence = ""
        self.buffer = []
        self.errors = 0
        self.sentence_start_time = None
        self.elapsed_saved = 0  # Сохраненное время при паузе
        self.typing_active = False
        self.paused = False
        self.time_per_word = 3.0
        self.time_limit_sentence = 0
        self.result_btn_frame = None
        self.pending_xp = 0  # Сколько XP дать после анимации

        self.theme = THEME
        self.init_ui()
        self.show_menu()
        self.update_timer_loop()
        self._start_shimmer()

        self.root.bind("<Escape>", self.toggle_pause)
        self.root.bind("<Tab>", self._on_restart_key)
        self.root.bind("<Return>", self._on_restart_key)
        self.root.bind("<KeyPress>", self.on_key)

        # === АНТИ-ЧИТ: ВСТАВКА ЗАПРЕЩЕНА ===
        for key in ["<Control-v>", "<Control-c>", "<Control-x>", "<Button-3>",
                    "<Control-V>", "<Control-C>", "<Control-X>", "<Shift-Insert>"]:
            self.root.bind_all(key, self.on_paste_attempt)

    def load_progress(self):
        try:
            if os.path.exists("player_data.json"):
                with open("player_data.json", "r") as f:
                    return json.load(f).get("xp", 0)
        except:
            pass
        return 0

    def save_progress(self):
        try:
            with open("player_data.json", "w") as f:
                json.dump({"xp": self.total_xp}, f)
        except:
            pass

    # === ЛОГИКА АНТИ-ЧИТА ===
    def on_paste_attempt(self, event):
        if not self.typing_active:
            return "break"

        # Сразу вызываем наказание, без счетчика попыток
        self.trigger_cheat_penalty()
        return "break"

    def trigger_cheat_penalty(self):
        self.typing_active = False
        self.sentence_start_time = None  # Останавливаем таймер

        self.text_area.config(state="normal")
        self.text_area.delete("1.0", "end")
        self.text_area.config(state="disabled")

        msg = "Наша команда запрещает пользоваться командами,\nлучше самому стараться и добиваться результата"
        self.animate_result_text(msg, False, "result_red")
        # После этого сработает логика проигрыша (кнопка рестарт выедет снизу)

    def _on_restart_key(self, event=None):
        if not self.typing_active:
            if hasattr(self, 'is_success_result') and self.is_success_result:
                self.show_menu()
            elif self.result_btn_frame:
                self.new_game()
        return "break"

    # ─────────────────────────────────────────────────────────────────────
    #  UI
    # ─────────────────────────────────────────────────────────────────────
    def init_ui(self):
        self.text_font = tkfont.Font(family="Consolas", size=26, weight="normal")
        self.ui_font_small = ("Segoe UI", 11)
        self.ui_font = ("Segoe UI", 14)
        self.root.configure(bg=self.theme["bg"])

        # ГЛАВНЫЙ КОНТЕЙНЕР
        self.container = tk.Frame(self.root, bg=self.theme["bg"])
        self.container.pack(fill="both", expand=True)

        # === 1. МЕНЮ ВЫБОРА ===
        self.menu_frame = tk.Frame(self.container, bg=self.theme["bg"])

        # Верхняя панель (Профиль и Язык)
        top_bar = tk.Frame(self.menu_frame, bg=self.theme["bg"])
        top_bar.pack(fill="x", padx=50, pady=40)

        # Индикатор XP в меню
        self.menu_xp_lbl = tk.Label(top_bar, text=f"Total XP: {self.total_xp}",
                                    font=("Consolas", 20, "bold"),
                                    bg=self.theme["bg"], fg=self.theme["gold"])
        self.menu_xp_lbl.pack(side="left")

        self.lang_btn = customtkinter.CTkButton(top_bar, text="RU", width=60,
                                                command=self.toggle_lang,
                                                fg_color=self.theme["surface"],
                                                hover_color=self.theme["subtext"])
        self.lang_btn.pack(side="right")

        # Центр меню
        center_frame = tk.Frame(self.menu_frame, bg=self.theme["bg"])
        center_frame.pack(expand=True)

        tk.Label(center_frame, text="ВЫБЕРИ СЛОЖНОСТЬ", font=("Segoe UI", 16),
                 bg=self.theme["bg"], fg=self.theme["subtext"]).pack(pady=(0, 30))

        # Сетка уровней (Grid)
        grid_frame = tk.Frame(center_frame, bg=self.theme["bg"])
        grid_frame.pack()

        levels = [10, 50, 100, 200, 500, 1000]
        row = 0
        col = 0
        for lvl in levels:
            btn = customtkinter.CTkButton(
                grid_frame,
                text=f"{lvl} XP",
                font=("Consolas", 24, "bold"),
                width=180, height=120,
                corner_radius=15,  # Закругленные углы
                fg_color=self.theme["surface"],
                text_color=self.theme["gold"],
                hover_color=self.theme["waiting"],
                command=lambda x=lvl: self.start_level(x)
            )
            btn.grid(row=row, column=col, padx=15, pady=15)
            col += 1
            if col > 2:
                col = 0
                row += 1

        # Кнопка выхода из приложения (внизу)
        exit_app_btn = customtkinter.CTkButton(
            self.menu_frame, text="ВЫХОД", fg_color=self.theme["danger"],
            hover_color="#a00", width=100, command=self.root.quit
        )
        exit_app_btn.pack(side="bottom", pady=40)

        # === 2. ИГРОВОЙ ИНТЕРФЕЙС ===
        self.game_frame = tk.Frame(self.container, bg=self.theme["bg"])

        # Верхняя панель игры
        game_top = tk.Frame(self.game_frame, bg=self.theme["bg"])
        game_top.pack(fill="x", padx=40, pady=20)

        back_btn = customtkinter.CTkButton(
            game_top, text="МЕНЮ", width=80, height=30,
            fg_color=self.theme["surface"], hover_color=self.theme["subtext"],
            command=self.confirm_exit_to_menu
        )
        back_btn.pack(side="left")

        # XP в игре
        self.game_xp_lbl = tk.Label(game_top, text=f"XP: {self.total_xp}",
                                    font=("Consolas", 16, "bold"),
                                    bg=self.theme["bg"], fg=self.theme["subtext"])
        self.game_xp_lbl.pack(side="right")

        tk.Frame(self.game_frame, bg=self.theme["bg"]).pack(expand=True, fill="both")  # Spacer

        self.game_content = tk.Frame(self.game_frame, bg=self.theme["bg"])
        self.game_content.pack(fill="x", padx=160)

        tk.Frame(self.game_frame, bg=self.theme["bg"]).pack(expand=True, fill="both")  # Spacer

        # Статистика
        stats_box = tk.Frame(self.game_content, bg=self.theme["bg"])
        stats_box.pack(pady=(0, 24))

        def make_stat(parent, label_text):
            f = tk.Frame(parent, bg=self.theme["bg"])
            f.pack(side="left", padx=44)
            val = tk.Label(f, text="0", font=("Consolas", 36, "bold"),
                           bg=self.theme["bg"], fg=self.theme["gold"])
            val.pack()
            tk.Label(f, text=label_text, font=self.ui_font_small,
                     bg=self.theme["bg"], fg=self.theme["subtext"]).pack()
            return val

        self.lbl_wpm = make_stat(stats_box, "wpm")
        self.lbl_acc = make_stat(stats_box, "точность")
        self.lbl_timer = make_stat(stats_box, "осталось")

        # Поле текста
        self.text_area = tk.Text(
            self.game_content, wrap="word",
            bg=self.theme["bg"], fg=self.theme["waiting"],
            font=self.text_font,
            bd=0, padx=0, pady=22,
            insertbackground=self.theme["cursor"], insertwidth=2,
            selectbackground=self.theme["bg"],
            highlightthickness=0,
            spacing1=10, spacing3=10,
            relief="flat", height=12
        )
        self.text_area.pack(fill="x", pady=(16, 0))

        # Теги цветов (С ЦЕНТРИРОВАНИЕМ РЕЗУЛЬТАТОВ)
        self.text_area.tag_config("correct", foreground=self.theme["correct"], background=self.theme["bg"])
        self.text_area.tag_config("wrong", foreground=self.theme["wrong"], background=self.theme["bg"])
        self.text_area.tag_config("waiting", foreground=self.theme["waiting"], background=self.theme["bg"])
        self.text_area.tag_configure("left_align", justify="left")

        # ЦЕНТРИРОВАНИЕ ДЛЯ РЕЗУЛЬТАТОВ
        self.text_area.tag_config("result_gold", foreground=self.theme["gold"], justify="center")
        self.text_area.tag_config("result_red", foreground=self.theme["danger"], justify="center")

    def toggle_lang(self):
        self.lang = "en" if self.lang == "ru" else "ru"
        self.lang_btn.configure(text=self.lang.upper())

    def update_xp_displays(self):
        self.menu_xp_lbl.config(text=f"Total XP: {self.total_xp}")
        self.game_xp_lbl.config(text=f"XP: {self.total_xp}")

    def show_menu(self):
        self.update_xp_displays()
        self.typing_active = False
        self.game_frame.pack_forget()
        self.menu_frame.pack(fill="both", expand=True)

    def confirm_exit_to_menu(self):
        if self.typing_active:
            ans = messagebox.askyesno("Выход", "Вы точно хотите выйти?\nТекст и прогресс будут сброшены.")
            if ans:
                self.show_menu()
        else:
            self.show_menu()

    def start_level(self, xp):
        self.xp_level = xp
        self.menu_frame.pack_forget()
        self.game_frame.pack(fill="both", expand=True)
        self.new_game()

    # ─────────────────────────────────────────────────────────────────────
    #  ГЕНЕРАЦИЯ ТЕКСТА
    # ─────────────────────────────────────────────────────────────────────
    def get_text_for_level(self):
        # Выбираем пул текстов
        bundle = TEXT_BUNDLES.get(self.lang, {})
        source_list = bundle.get("classics" if self.lang == "ru" else "mixed", [])

        if not source_list:
            return "Error: No text found."

        count_map = {10: 1, 50: 3, 100: 6, 200: 12, 500: 25, 1000: 50}
        count = count_map.get(self.xp_level, 1)

        selected = random.sample(source_list, min(count, len(source_list)))

        # АВТОМАТИЧЕСКАЯ ЗАГЛАВНАЯ БУКВА
        formatted_selected = []
        for s in selected:
            s = s.strip()
            if s:
                s = s[0].upper() + s[1:]
                formatted_selected.append(s)

        return " ".join(formatted_selected)

    def new_game(self, event=None):
        if self.result_btn_frame:
            self.result_btn_frame.destroy()
            self.result_btn_frame = None

        self.update_xp_displays()
        self.current_sentence = self.get_text_for_level().replace("—", "-")
        self.buffer = []
        self.errors = 0
        self.sentence_start_time = None
        self.elapsed_saved = 0  # Сброс сохраненного времени
        self.typing_active = True
        self.paused = False
        self.pending_xp = 0

        self.lbl_wpm.config(text="0", fg=self.theme["gold"])
        self.lbl_acc.config(text="0%", fg=self.theme["gold"])

        words = len(self.current_sentence.split())
        self.time_limit_sentence = max(int(words * self.time_per_word), 5)

        self.lbl_timer.config(text=f"{self.time_limit_sentence}s",
                              fg=self.theme["gold"], font=("Consolas", 36, "bold"))

        self.text_area.config(state="normal")
        self.text_area.delete("1.0", "end")
        self.text_area.insert("1.0", self.current_sentence, ("waiting", "left_align"))
        self.text_area.config(state="disabled")
        self.text_area.mark_set("insert", "1.0")
        self.text_area.see("1.0")
        self.text_area.focus_set()

    # ─────────────────────────────────────────────────────────────────────
    #  АНИМАЦИИ И ЭФФЕКТЫ
    # ─────────────────────────────────────────────────────────────────────
    def play_somersault(self, callback):
        steps = 12
        orig_size = 26

        def step(s):
            if s > steps * 2:
                self.text_font.configure(size=orig_size)
                self.text_area.tag_delete("somersault")
                callback()
                return
            if s <= steps:
                size = max(2, int(orig_size * (1 - (s / steps))))
                offset = int((s / steps) * 30)
            else:
                size = max(2, int(orig_size * ((s - steps) / steps)))
                offset = int((1 - ((s - steps) / steps)) * 30)
            self.text_font.configure(size=size)
            self.text_area.tag_add("somersault", "1.0", "end")
            self.text_area.tag_configure("somersault", offset=offset)
            self.root.after(20, lambda: step(s + 1))

        step(0)

    def animate_result_text(self, text, is_success, color_tag):
        self.text_area.config(state="normal")
        self.text_area.delete("1.0", "end")
        self.result_text_full = text
        self.result_text_index = 0
        self.is_success_result = is_success
        self.result_color_tag = color_tag
        self.text_area.config(state="disabled")
        self._typewriter_tick()

    def _typewriter_tick(self):
        if self.result_text_index < len(self.result_text_full):
            self.text_area.config(state="normal")
            char = self.result_text_full[self.result_text_index]
            # Используем тег, который теперь центрирован (result_gold/red)
            self.text_area.insert("end", char, (self.result_color_tag))
            self.text_area.tag_add(self.result_color_tag, "1.0", "end")  # Принудительно центрируем
            self.text_area.config(state="disabled")
            self.result_text_index += 1
            self.root.after(35, self._typewriter_tick)
        else:
            self.show_result_button(self.is_success_result)

    def show_result_button(self, is_success):
        self.result_btn_frame = tk.Frame(self.game_content, bg=self.theme["bg"])

        # === ПОБЕДА (ДАЛЕЕ) ===
        if is_success:
            # Обновляем XP (с учетом бонуса, рассчитанного в finish_sentence)
            earned = self.pending_xp
            self.total_xp += earned
            self.save_progress()
            self.update_xp_displays()

            info_lbl = tk.Label(self.result_btn_frame, text=f"+{earned} XP ПОЛУЧЕНО!",
                                bg=self.theme["bg"], fg=self.theme["gold"],
                                font=("Consolas", 18, "bold"))
            info_lbl.pack(pady=(0, 10))

            # Кнопка "ДАЛЕЕ"
            cont_btn = customtkinter.CTkButton(
                self.result_btn_frame,
                text="ДАЛЕЕ  →",
                font=("Consolas", 18, "bold"),
                width=200, height=50,
                corner_radius=25,
                fg_color=self.theme["gold"],
                text_color=self.theme["bg"],
                hover_color=self.theme["teal"],
                command=self.new_game
            )
            cont_btn.pack(side="left", padx=10)

            # Кнопка "МЕНЮ"
            menu_btn = customtkinter.CTkButton(
                self.result_btn_frame,
                text="МЕНЮ",
                font=("Consolas", 14, "bold"),
                width=100, height=50,
                corner_radius=25,
                fg_color=self.theme["surface"],
                text_color=self.theme["text"],
                hover_color=self.theme["waiting"],
                command=self.show_menu
            )
            menu_btn.pack(side="left", padx=10)

            # Анимация выезда для победы тоже
            self.result_btn_frame.place(relx=0.5, rely=1.0, anchor="n")
            self.animate_slide_up(self.result_btn_frame, target_rely=0.6)

        # === ПОРАЖЕНИЕ / ЧИТ (РЕСТАРТ) ===
        else:
            restart_btn = customtkinter.CTkButton(
                self.result_btn_frame,
                text="ПОПРОБОВАТЬ СНОВА",
                font=("Consolas", 18, "bold"),
                width=250, height=60,
                corner_radius=30,
                fg_color=self.theme["surface"],
                text_color=self.theme["text"],
                hover_color=self.theme["waiting"],
                command=self.new_game
            )
            restart_btn.pack()

            # Анимация выезда снизу
            self.result_btn_frame.place(relx=0.5, rely=1.0, anchor="n")
            self.animate_slide_up(self.result_btn_frame, target_rely=0.6)

    def animate_slide_up(self, widget, target_rely, current_rely=1.0):
        if not widget.winfo_exists():
            return
        if current_rely > target_rely:
            current_rely -= 0.015
            widget.place(relx=0.5, rely=current_rely, anchor="center")
            self.root.after(10, lambda: self.animate_slide_up(widget, target_rely, current_rely))

    # ─────────────────────────────────────────────────────────────────────
    #  SHIMMER И ЭФФЕКТЫ
    # ─────────────────────────────────────────────────────────────────────
    def _start_shimmer(self):
        self._shimmer_tick()

    def _shimmer_tick(self):
        try:
            if self.typing_active and not self.paused and self.current_sentence:
                pos = len(self.buffer)
                total = len(self.current_sentence)
                if pos < total:
                    t = time.time() * 1.0
                    br, bg_, bb = self.theme["sh_dark"]
                    pr, pg, pb = self.theme["sh_light"]
                    self.text_area.config(state="normal")
                    for i in range(pos, min(total, pos + 100)):
                        wave = (math.sin(t - i * 0.3) + 1) / 2
                        r = int(br + (pr - br) * wave)
                        g = int(bg_ + (pg - bg_) * wave)
                        b = int(bb + (pb - bb) * wave)
                        tag = f"sh_{i}"
                        self.text_area.tag_config(tag, foreground=f"#{r:02x}{g:02x}{b:02x}")
                        self.text_area.tag_remove(tag, "1.0", "end")
                        self.text_area.tag_add(tag, f"1.0+{i}c", f"1.0+{i + 1}c")
                    self.text_area.config(state="disabled")
        except:
            pass
        self.root.after(55, self._shimmer_tick)

    def animate_char(self, idx, is_correct):
        tag = "correct" if is_correct else "wrong"
        try:
            self.text_area.config(state="normal")
            all_tags = list(self.text_area.tag_names(f"1.0+{idx}c"))
            for t in all_tags:
                self.text_area.tag_remove(t, f"1.0+{idx}c", f"1.0+{idx + 1}c")
            self.text_area.tag_add(tag, f"1.0+{idx}c", f"1.0+{idx + 1}c")
            self.text_area.tag_raise(tag)
            self.text_area.config(state="disabled")
        except:
            pass

    def remove_char_highlight(self, idx):
        try:
            self.text_area.config(state="normal")
            all_tags = list(self.text_area.tag_names(f"1.0+{idx}c"))
            for t in all_tags:
                self.text_area.tag_remove(t, f"1.0+{idx}c", f"1.0+{idx + 1}c")
            self.text_area.tag_add("waiting", f"1.0+{idx}c", f"1.0+{idx + 1}c")
            self.text_area.config(state="disabled")
        except:
            pass

    # ─────────────────────────────────────────────────────────────────────
    #  ВВОД С КЛАВИАТУРЫ
    # ─────────────────────────────────────────────────────────────────────
    def on_key(self, e):
        # Если игра на паузе, и нажали букву -> снимаем паузу и восстанавливаем время
        if self.paused:
            # Игнорируем спецклавиши, чтобы случайно не продолжить
            if len(e.keysym) > 1 and e.keysym not in ['BackSpace', 'space', 'minus', 'exclam', 'question', 'comma',
                                                      'period']:
                return "break"

            self.paused = False
            # Восстанавливаем точку старта, учитывая накопленное время
            if self.sentence_start_time is None:
                self.sentence_start_time = time.time() - self.elapsed_saved

        if not self.typing_active:
            return "break"

        if len(e.keysym) > 1 and e.keysym not in ['BackSpace', 'space', 'minus', 'exclam', 'question', 'comma',
                                                  'period']:
            if len(e.char) == 0: return

        # === ИСПРАВЛЕНИЕ: Таймер стартует ТОЛЬКО здесь ===
        if self.sentence_start_time is None:
            if e.keysym != "BackSpace":
                self.sentence_start_time = time.time()

        if e.keysym == "BackSpace":
            if self.buffer:
                idx = len(self.buffer) - 1
                removed = self.buffer.pop()
                if idx < len(self.current_sentence) and removed != self.current_sentence[idx]:
                    self.errors = max(0, self.errors - 1)
                self.remove_char_highlight(idx)
                try:
                    self.text_area.see(f"1.0+{idx}c")
                except:
                    pass
                if self.buffer:
                    cf = sum(1 for i, c in enumerate(self.buffer)
                             if i < len(self.current_sentence) and c == self.current_sentence[i])
                    self.lbl_acc.config(text=f"{max(0, int(cf / len(self.buffer) * 100))}%")
                else:
                    self.lbl_acc.config(text="0%")
            return "break"

        char_input = e.char
        if not char_input or ord(char_input) < 32:
            return "break"

        if len(self.buffer) < len(self.current_sentence):
            idx = len(self.buffer)
            expected = self.current_sentence[idx]
            self.buffer.append(char_input)

            is_correct = (char_input == expected)
            if not is_correct:
                self.errors += 1

            self.animate_char(idx, is_correct)

            try:
                self.text_area.see(f"1.0+{idx + 2}c")
            except:
                pass

            cf = len(self.buffer) - self.errors
            self.lbl_acc.config(text=f"{max(0, int(cf / len(self.buffer) * 100))}%")

            if len(self.buffer) == len(self.current_sentence):
                self.finish_sentence()
        return "break"

    def finish_sentence(self):
        self.typing_active = False
        cf = sum(1 for i, c in enumerate(self.buffer)
                 if i < len(self.current_sentence) and c == self.current_sentence[i])
        acc = int(cf / len(self.buffer) * 100) if self.buffer else 0

        if acc < 70:
            self.animate_result_text("Пиши точнее\nУровень провален", False, "result_red")
        else:
            # === БОНУС 50% ЗА ИДЕАЛЬНОЕ ВЫПОЛНЕНИЕ ===
            if acc == 100:
                self.pending_xp = self.xp_level + int(self.xp_level * 0.5)  # Ставка + 50%
                msg = "Идеально!\nНи одной ошибки!"
            else:
                self.pending_xp = self.xp_level
                msg = "Уровень завершен\nМолодец"

            self.play_somersault(lambda: self.animate_result_text(msg, True, "result_gold"))

    def update_timer_loop(self):
        try:
            if self.typing_active and not self.paused:
                # === ИСПРАВЛЕНИЕ: Если таймер еще не запущен (None), показываем полное время и не вычитаем ===
                if self.sentence_start_time is None:
                    self.lbl_timer.config(text=f"{self.time_limit_sentence}s", fg=self.theme["gold"])
                else:
                    elapsed = time.time() - self.sentence_start_time
                    remaining = max(0.0, self.time_limit_sentence - elapsed)
                    sec = int(remaining)

                    if remaining <= 0:
                        self.typing_active = False
                        self.lbl_timer.config(text="0s", fg=self.theme["danger"])
                        self.animate_result_text("Время вышло\nУровень провален", False, "result_red")
                    else:
                        color = self.theme["danger"] if remaining <= 5 else self.theme["gold"]
                        self.lbl_timer.config(text=f"{sec}s", fg=color)

                    if elapsed > 0.2:
                        wpm = (len(self.buffer) / 5) / (elapsed / 60)
                        self.lbl_wpm.config(text=str(int(wpm)))
        except:
            pass
        self.root.after(80, self.update_timer_loop)

    def toggle_pause(self, event=None):
        self.paused = not self.paused


if __name__ == "__main__":
    root = customtkinter.CTk()
    app = AlexTypeTrainer(root)
    root.mainloop()